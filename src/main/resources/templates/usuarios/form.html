<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title th:text="${isNew} ? 'Novo Usuário' : 'Editar Usuário'">Novo Usuário - MotusWatch</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"/>
</head>
<body th:with="pageTitle=${isNew} ? 'Novo Usuário' : 'Editar Usuário', content=~{::content}" th:insert="~{fragments/layout}">

<div th:fragment="content">
    <div class="linha">
        <div class="coluna-12">
            <div class="card">
                <div class="cabecalho-card">
                    <h5 class="titulo-pequeno">
                        <span th:text="${isNew} ? 'Novo Usuário' : 'Editar Usuário'">Novo Usuário</span>
                    </h5>
                </div>
                <div class="corpo-card">
                    <form th:object="${usuario}" 
                          th:action="${isNew} ? @{/usuarios} : @{|/usuarios/${usuario.id}|}" 
                          method="post">

                        <div class="row g-3">
                            <div class="col-md-6" th:if="${!isNew}">
                                <label class="form-label">ID</label>
                                <input class="form-control" th:value="*{id}" readonly/>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Nome <span class="text-danger">*</span></label>
                                <input class="form-control" th:field="*{nome}" 
                                       placeholder="Digite o nome completo" required/>
                                <div class="text-danger small" th:if="${#fields.hasErrors('nome')}" 
                                     th:errors="*{nome}"></div>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">CPF <span class="text-danger">*</span></label>
                                <input class="form-control" th:field="*{cpf}" 
                                       placeholder="000.000.000-00" required/>
                                <div class="text-danger small" th:if="${#fields.hasErrors('cpf')}" 
                                     th:errors="*{cpf}"></div>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" th:field="*{email}" 
                                       placeholder="usuario@email.com"/>
                                <div class="text-danger small" th:if="${#fields.hasErrors('email')}" 
                                     th:errors="*{email}"></div>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Telefone</label>
                                <input class="form-control" th:field="*{telefone}" 
                                       placeholder="(11) 99999-9999"/>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Perfil <span class="text-danger">*</span></label>
                                <select class="form-select" th:field="*{perfil}" required>
                                    <option value="">Selecione o perfil</option>
                                    <option th:each="perfil : ${perfis}" 
                                            th:value="${perfil}" 
                                            th:text="${perfil}"></option>
                                </select>
                                <div class="text-danger small" th:if="${#fields.hasErrors('perfil')}" 
                                     th:errors="*{perfil}"></div>
                            </div>

                            <div class="col-md-6" th:if="${isNew}">
                                <label class="form-label">Senha <span class="text-danger">*</span></label>
                                <input type="password" class="form-control" th:field="*{senha}" 
                                       placeholder="Digite a senha" th:if="${isNew}" required/>
                                <div class="text-danger small" th:if="${#fields.hasErrors('senha')}" 
                                     th:errors="*{senha}"></div>
                            </div>

                            <div class="col-md-6" th:if="${!isNew}">
                                <label class="form-label">Nova Senha</label>
                                <input type="password" class="form-control" th:field="*{senha}" 
                                       placeholder="Deixe em branco para manter a senha atual"/>
                                <small class="form-text text-muted">Deixe em branco para manter a senha atual</small>
                            </div>
                        </div>

                        <div class="d-flex gap-2 mt-4">
                            <button class="btn btn-primary" type="submit">
                                <span th:text="${isNew} ? 'Salvar' : 'Atualizar'">Salvar</span>
                            </button>
                            <a class="btn btn-outline-secondary" th:href="@{/usuarios}">
                                Cancelar
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>

    </div>
</div>

</body>
</html>
