<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Usuários - MotusWatch</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"/>
</head>
<body th:with="pageTitle='Usuários', content=~{::content}" th:insert="~{fragments/layout}">

<div th:fragment="content">
    <div class="flexivel espaco-entre alinhar-centro margem-baixo-4">
        <h1 class="titulo">
            Gestão de Usuários
        </h1>
        <a th:href="@{/usuarios/novo}" class="botao">
            Novo Usuário
        </a>
    </div>

    <div class="card">
        <div class="corpo-card">
            <div class="tabela-responsiva">
                <table class="table table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>Nome</th>
                            <th>CPF</th>
                            <th>Email</th>
                            <th>Perfil</th>
                            <th class="text-end">Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="usuario : ${usuarios.content}">
                            <td th:text="${usuario.id}">1</td>
                            <td th:text="${usuario.nome}">João Silva</td>
                            <td th:text="${usuario.cpf}">123.456.789-00</td>
                            <td th:text="${usuario.email}">joao@email.com</td>
                            <td>
                                <span th:class="${usuario.perfil == 'ADMIN' ? 'etiqueta etiqueta-vermelha' : 'etiqueta etiqueta-azul'}"
                                      th:text="${usuario.perfil}">USER</span>
                            </td>
                            <td>
                                <span th:class="${usuario.ativo ? 'etiqueta etiqueta-verde' : 'etiqueta etiqueta-cinza'}"
                                      th:text="${usuario.ativo ? 'Ativo' : 'Inativo'}">Ativo</span>
                            </td>
                            <td class="texto-direita">
                                <div class="grupo-botoes" role="group">
                                    <a th:href="@{|/usuarios/${usuario.id}/editar|}" 
                                       class="botao-outline botao-pequeno">
                                        Editar
                                    </a>
                                    <a th:href="@{|/usuarios/${usuario.id}/excluir|}" 
                                       class="botao-secundario botao-pequeno"
                                       onclick="return confirm('Tem certeza que deseja excluir este usuário?')">
                                        Excluir
                                    </a>
                                </div>
                            </td>
                        </tr>
                        <tr th:if="${usuarios.content.isEmpty()}">
                            <td colspan="7" class="text-center text-muted">
                                Nenhum usuário encontrado
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Paginação -->
            <nav th:if="${usuarios.totalPages > 1}" class="mt-3">
                <ul class="pagination justify-content-center">
                    <li class="page-item" th:classappend="${usuarios.first} ? 'disabled'">
                        <a class="page-link" th:href="@{/usuarios(page=${usuarios.number-1}, size=${usuarios.size})}">
                            Anterior
                        </a>
                    </li>
                    <li class="page-item disabled">
                        <span class="page-link" th:text="${usuarios.number + 1} + ' / ' + ${usuarios.totalPages}">1 / 1</span>
                    </li>
                    <li class="page-item" th:classappend="${usuarios.last} ? 'disabled'">
                        <a class="page-link" th:href="@{/usuarios(page=${usuarios.number+1}, size=${usuarios.size})}">
                            Próxima
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>

</body>
</html>
